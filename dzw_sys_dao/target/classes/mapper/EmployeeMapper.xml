<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.accp.dao.EmployeeMapper">
	<resultMap id="BaseResultMap" type="com.accp.pojo.Employee">
		<id column="eid" property="eid" jdbcType="INTEGER" />
		<result column="jurisdictionid" property="jurisdictionid"
			jdbcType="INTEGER" />
		<result column="shopid" property="shopid" jdbcType="INTEGER" />
		<result column="etypeid" property="etypeid" jdbcType="INTEGER" />
		<result column="staffaeid" property="staffaeid"
			jdbcType="INTEGER" />
		<result column="stationid" property="stationid"
			jdbcType="INTEGER" />
		<result column="dimissionid" property="dimissionid"
			jdbcType="INTEGER" />
		<result column="groupid" property="groupid" jdbcType="INTEGER" />
		<result column="eno" property="eno" jdbcType="VARCHAR" />
		<result column="ename" property="ename" jdbcType="VARCHAR" />
		<result column="eaccount" property="eaccount"
			jdbcType="VARCHAR" />
		<result column="epwd" property="epwd" jdbcType="VARCHAR" />
		<result column="esex" property="esex" jdbcType="INTEGER" />
		<result column="ephone" property="ephone" jdbcType="VARCHAR" />
		<result column="eemail" property="eemail" jdbcType="VARCHAR" />
		<result column="eaddress" property="eaddress"
			jdbcType="VARCHAR" />
		<result column="einputDate" property="einputdate"
			jdbcType="DATE" />
		<result column="ecurriculumvitae" property="ecurriculumvitae"
			jdbcType="VARCHAR" />
		<result column="eimage" property="eimage" jdbcType="VARCHAR" />
		<result column="eidentity" property="eidentity"
			jdbcType="VARCHAR" />
		<result column="deid" property="deid" jdbcType="INTEGER" />
		<association property="dim" column="eid" select="selectDimById"></association>
		<association property="depart" column="deid" select="selectDepartId"></association>
		<association property="station" column="stationid" select="selectStationById"></association>
		<association property="group1" column="groupid" select="selectgroupAll"></association>
		<association property="starlevel" column="starid" select="selectStartlevel1"></association>
	</resultMap>
	<!-- 组织机构 -->
	<select id="selectAllByNameandDepartmentAndStation" resultMap="BaseResultMap">
		SELECT * FROM employee
		<where>
			etypeid=1
			<if test='deid!=-1'>
				and deid=#{deid}
			</if>
			<if test="ename!='-1'">
				and ename like '%${ename}%'
			</if>
		</where>
	</select>
	<select id="selectById" resultType="com.accp.pojo.Employee">
		SELECT * FROM employee where eid=#{eid}
	</select>
	<insert id="addEmployee">
		INSERT INTO
		employee(jurisdictionid,eno,ename,esex,eaccount,epwd,deid,stationid,eidentity,eaddress,ephone,eemail,einputDate)
		VALUE(#{jurisdictionid},#{eno},#{ename},#{esex},#{eaccount},#{epwd},#{deid},#{stationid},#{eidentity},#{eaddress},#{ephone},#{eemail},NOW());
	</insert>
	<select id="selectDimById" resultType="com.accp.pojo.Dimissiontext">
		select * from dimissiontext where eid=#{0}
	</select>
	<select id="selectEmpByEid" resultMap="BaseResultMap">
		select * from employee where etypeid=2
	</select>
	<update id="updateEmployee">
		UPDATE employee SET eno=#{eno},ename=#{ename},esex=#{esex},eaccount=#{eaccount},epwd=#{epwd},deid={deid},stationid=#{stationid},eidentity=#{eidentity},eaddress=#{eaddress},ephone=#{ephone},eemail={eemail},einputDate=#{einputDate} WHERE eid=#{eid}
	</update>
	<delete id="delEmployee">
		DELETE FROM employee WHERE eid=#{eid}
	</delete>
	
	<update id="updateEmployeeByEid1">
		UPDATE employee SET etypeid=2 WHERE eid=#{eid}
	</update>
	
	<update id="updateEmployeeByEid2">
		UPDATE employee SET etypeid=1 WHERE eid=#{eid}
	</update>
	
	<insert id="insertDimByEid">
		INSERT INTO dimissiontext(eid,dimissiondate,dimissioncause) VALUE(#{eid},#{dimissiondate},#{dimissioncause})
	</insert>
	
	<select id="selectEmpNameAndId" resultType="com.accp.pojo.Employee">
		SELECT eid,ename FROM employee
	</select>
	
	<select id="selectDepartId" resultType="com.accp.pojo.Department">
		SELECT * FROM department WHERE deid=#{deid}
	</select>
	
	<select id="selectStationById" resultType="com.accp.pojo.Station">
		SELECT * FROM station WHERE stationid=#{stationid}
	</select>
	
	<delete id="delDimission">
		DELETE FROM dimissiontext WHERE eid=#{eid}
	</delete>
	
	<select id="selectStationAll" resultType="com.accp.pojo.Station">
		SELECT * FROM station
	</select>
	
	<select id="selectgroupAll" resultType="com.accp.pojo.Group">
		SELECT * FROM group1 where groupid=#{groupid}
	</select>
	
	<select id="selectStartlevel1" resultType="com.accp.pojo.Starlevel">
		SELECT * FROM starlevel where starid=#{starid}
	</select>
	
	<insert id="addGroup">		
		INSERT INTO group1(groupname) VALUE(#{groupname})
	</insert>
	
	<update id="updateGroupByGroupid">
		UPDATE employee SET groupid=#{groupid} WHERE eid=#{eid}
	</update>
	
	<update id="updateGroup">
		update group set groupname=#{group1.groupname} where groupid=#{group1.groupid}
	</update>
	
	<delete id="delGroupByid">
		DELETE FROM group WHERE groupid=#{groupid}
	</delete>
	
	<select id="selectGroup11" resultType="com.accp.pojo.Group">
		SELECT * FROM group1
	</select>
	
	<select id="queryAllEmpGroupStarlevel" resultMap="BaseResultMap">
		select * from employee 
		<where>
			etypeid=1
			<if test='groupid!=-1'>
				and groupid=#{groupid}
			</if>
		</where>
	</select>
	<select id="queryStarlevelAll" resultType="com.accp.pojo.Starlevel">
		select * from starlevel
	</select>
</mapper>